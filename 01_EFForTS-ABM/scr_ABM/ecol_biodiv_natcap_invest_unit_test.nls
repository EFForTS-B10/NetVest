to test-invest
  print["testing invest"]
   ;; definition of experiment name and working directory
   let experiment inv-test
	print (word "experiment:"experiment)
   ;; clear all
   ca
	 set workdir word "/home/dockerj/EFForTS-ABM/01_EFForTS-ABM/tests_integration/01_unittest/" experiment
  print ( word "workdir:" workdir)
  let half-saturation-constant k
	 ;; setup python, load invest package (defined in ecol_biodiv_natcap_invest.nls)
	 natcap_invest_set_up_invest
	 ;; load sensitivity table and impact table and store as csv-table (defined in ecol_biodiv_natcap_invest.nls)
	 natcap_invest_write_tables
   ;; lulc.asc, oilpalm_c.asc and rubber_c.asc considered input for testing
   foreach ["lulc" "oilpalm_c" "rubber_c"]
[
    [x] ->
    natcap_invest_file_copy_tif (x)
  ]
   ;natcap_invest_file_copy_tif "lulc"
   ;natcap_invest_file_copy_tif "oilpalm_c"
   ;natcap_invest_file_copy_tif "rubber_c"
   ;; convert asc files from output folder to tif files
   natcap_invest_convert_maps_tif
   ;; execution of Invest with working directory of InVEST
   let invest_wd word workdir "/output"
  print (word "invest_wd:" invest_wd)
   natcap_invest_execute_invest invest_wd experiment half-saturation-constant ;expects working_directory, 'sensitivity_table.csv' 'impact_table.csv' 'lulc.tif'
   natcap_invest_convert_maps_asc experiment

  print ["Success"]
  print ["Success"]
                                                     
end

to natcap_invest_file_copy_tif [file]
  print ["Copying files from input to output folder"]
    let file_in   (word  workdir "/input/" file ".asc")
    print file_in
    let file_out   (word  workdir "/output/" file ".asc")
    print file_out
    let file_conv  (word  workdir "/output/" file)

    py:set "file_in" file_in
    py:set "file_out" file_out
    py:run "from shutil import copyfile"
    py:run "copyfile(file_in, file_out)"
    print (word "copied to file_out:" file_out)
end

to do-nothing ;because nlrx demands to run an additional function
end
